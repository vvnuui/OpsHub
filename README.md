# è¿ç»´ç»Ÿä¸€é—¨æˆ·ç³»ç»Ÿ (Yunwei SSO Portal)

ä¸€ä¸ªç»Ÿä¸€çš„è¿ç»´ç³»ç»Ÿå¯¼èˆªé—¨æˆ·ï¼Œé›†æˆäº†å¤šä¸ªè¿ç»´ç³»ç»Ÿçš„å…¥å£ï¼Œæä¾›ä¾¿æ·çš„ç³»ç»Ÿè®¿é—®å’Œé…ç½®ç®¡ç†åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **ç³»ç»Ÿå¯¼èˆª** - å¡ç‰‡å¼å±•ç¤ºæ‰€æœ‰ç³»ç»Ÿï¼Œç‚¹å‡»å¿«é€Ÿè·³è½¬
- **é…ç½®ç®¡ç†** - åŠ¨æ€æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ç³»ç»Ÿé…ç½®
- **å“åº”å¼è®¾è®¡** - æ”¯æŒPCå’Œç§»åŠ¨ç«¯è®¿é—®
- **çŠ¶æ€ç®¡ç†** - ç³»ç»Ÿå¯ç”¨/åœç”¨çŠ¶æ€æ§åˆ¶
- **é¢„ç•™æ‰©å±•** - ä¸ºåç»­SSOç»Ÿä¸€è®¤è¯é¢„ç•™æ¥å£

## æŠ€æœ¯æ ˆ

### å‰ç«¯
- Vue 3 - æ¸è¿›å¼JavaScriptæ¡†æ¶
- Element Plus - Vue 3 ç»„ä»¶åº“
- Vue Router - å®˜æ–¹è·¯ç”±ç®¡ç†å™¨
- Axios - HTTPå®¢æˆ·ç«¯
- Vite - ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·

### åç«¯
- Node.js - JavaScriptè¿è¡Œæ—¶
- Express - Webåº”ç”¨æ¡†æ¶
- JSONæ–‡ä»¶å­˜å‚¨ - è½»é‡çº§æ•°æ®å­˜å‚¨
- CORS - è·¨åŸŸèµ„æºå…±äº«

## é¡¹ç›®ç»“æ„

```
yunwei_sso/
â”œâ”€â”€ frontend/                   # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/             # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.vue       # ç³»ç»Ÿå¯¼èˆªé¦–é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ SystemManage.vue  # ç³»ç»Ÿé…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ components/        # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ SystemCard.vue # ç³»ç»Ÿå¡ç‰‡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/               # APIæ¥å£å°è£…
â”‚   â”‚   â”‚   â””â”€â”€ system.js
â”‚   â”‚   â”œâ”€â”€ router/            # è·¯ç”±é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ App.vue            # æ ¹ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.js            # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ backend/                    # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/            # è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ system.js      # ç³»ç»Ÿé…ç½®è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ db/                # æ•°æ®åº“
â”‚   â”‚   â”‚   â””â”€â”€ database.js    # æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â””â”€â”€ app.js             # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ systems.json       # JSONæ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â””â”€â”€ README.md
```

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js >= 16.0.0
- npm æˆ– yarn æˆ– pnpm

### æ–¹å¼1ï¼šå¼€å‘æ¨¡å¼ï¼ˆå‰åç«¯åˆ†ç¦»ï¼‰

#### å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
cd backend
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd ../frontend
npm install
```

#### å¯åŠ¨æœåŠ¡

```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡ (ç»ˆç«¯1)
cd backend
npm run dev

# 2. å¯åŠ¨å‰ç«¯æœåŠ¡ (ç»ˆç«¯2)
cd frontend
npm run dev
```

#### è®¿é—®åº”ç”¨

- å‰ç«¯åœ°å€: http://localhost:5173
- åç«¯API: http://localhost:3000/api

### æ–¹å¼2ï¼šç”Ÿäº§æ¨¡å¼ï¼ˆä¸€é”®éƒ¨ç½²ï¼‰â­ æ¨è

**åªéœ€å¯åŠ¨åç«¯å³å¯è®¿é—®å®Œæ•´åº”ç”¨**

#### Windowsç³»ç»Ÿ

```powershell
# ä¸€é”®éƒ¨ç½²
.\deploy.ps1

# å¯åŠ¨æœåŠ¡
cd backend
npm start
```

#### Linux/Macç³»ç»Ÿ

```bash
# ä¸€é”®éƒ¨ç½²
chmod +x deploy.sh
./deploy.sh

# å¯åŠ¨æœåŠ¡
cd backend
npm start
```

#### UbuntuæœåŠ¡å™¨éƒ¨ç½²ï¼ˆåŒ…å«systemdé…ç½®ï¼‰

Ubuntuç³»ç»Ÿæ¨èä½¿ç”¨ä¸“ç”¨éƒ¨ç½²è„šæœ¬ï¼Œ**é»˜è®¤éƒ¨ç½²åˆ° `/data/yunwei_sso`**ï¼š

```bash
# ä¸€é”®éƒ¨ç½²ï¼ˆè‡ªåŠ¨é…ç½®systemdæœåŠ¡ï¼‰
chmod +x deploy-ubuntu.sh
./deploy-ubuntu.sh

# éƒ¨ç½²æ—¶é€‰æ‹©ï¼š
# 1. éƒ¨ç½²åˆ° /data/yunwei_sso ï¼ˆæ¨èï¼‰â­
# 2. åœ¨å½“å‰ç›®å½•éƒ¨ç½²
# 3. è‡ªå®šä¹‰è·¯å¾„

# æœåŠ¡ç®¡ç†
sudo systemctl start yunwei-sso    # å¯åŠ¨
sudo systemctl status yunwei-sso   # çŠ¶æ€
journalctl -u yunwei-sso -f        # æ—¥å¿—
```

**éƒ¨ç½²æ–‡æ¡£ï¼š**
- ğŸ“˜ å®Œæ•´æŒ‡å—ï¼š[UBUNTU_DEPLOY.md](./UBUNTU_DEPLOY.md)
- ğŸš€ å¿«é€Ÿä¸Šæ‰‹ï¼š[QUICK_START_UBUNTU.md](./QUICK_START_UBUNTU.md)

#### è®¿é—®åº”ç”¨

- åº”ç”¨åœ°å€: **http://localhost:3000**ï¼ˆå‰åç«¯åˆä¸€ï¼‰

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ï¼š[DEPLOY.md](./DEPLOY.md)

## APIæ¥å£æ–‡æ¡£

### è·å–æ‰€æœ‰ç³»ç»Ÿ
```
GET /api/systems
```

### è·å–å•ä¸ªç³»ç»Ÿ
```
GET /api/systems/:id
```

### åˆ›å»ºç³»ç»Ÿ
```
POST /api/systems
Content-Type: application/json

{
  "name": "ç³»ç»Ÿåç§°",
  "url": "http://localhost:8001",
  "icon": "Monitor",
  "description": "ç³»ç»Ÿæè¿°",
  "order_num": 1,
  "status": "active"
}
```

### æ›´æ–°ç³»ç»Ÿ
```
PUT /api/systems/:id
Content-Type: application/json

{
  "name": "ç³»ç»Ÿåç§°",
  "url": "http://localhost:8001",
  "icon": "Monitor",
  "description": "ç³»ç»Ÿæè¿°",
  "order_num": 1,
  "status": "active"
}
```

### åˆ é™¤ç³»ç»Ÿ
```
DELETE /api/systems/:id
```

## é»˜è®¤ç³»ç»Ÿé…ç½®

ç³»ç»Ÿåˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨åˆ›å»º7ä¸ªé»˜è®¤ç³»ç»Ÿï¼š

1. **WGç›‘æ§ç³»ç»Ÿ** - WireGuard VPNç›‘æ§ç®¡ç†ç³»ç»Ÿ
2. **Mwan3ç³»ç»Ÿ** - Mwan3å¤šçº¿è·¯è´Ÿè½½å‡è¡¡ç³»ç»Ÿ
3. **FRPç³»ç»Ÿ** - FRPå†…ç½‘ç©¿é€ç®¡ç†ç³»ç»Ÿ
4. **Google Youtubeç›‘æ§** - Google YoutubeæœåŠ¡ç›‘æ§ç³»ç»Ÿ
5. **ä»“åº“ç®¡ç†ç³»ç»Ÿ** - ç‰©èµ„ä»“åº“ç®¡ç†ç³»ç»Ÿ
6. **è™šæ‹Ÿæœºç”³è¯·ç³»ç»Ÿ** - è™šæ‹Ÿæœºèµ„æºç”³è¯·ä¸ç®¡ç†ç³»ç»Ÿ
7. **AIæœåŠ¡å™¨ç›‘æ§** - AIæœåŠ¡å™¨æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

> æ³¨æ„ï¼šé»˜è®¤URLä¸ºlocalhostå ä½åœ°å€ï¼Œè¯·åœ¨"ç³»ç»Ÿç®¡ç†"é¡µé¢ä¿®æ”¹ä¸ºå®é™…åœ°å€ã€‚

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### æ„å»ºå‰ç«¯

```bash
cd frontend
npm run build
```

æ„å»ºäº§ç‰©åœ¨ `frontend/dist` ç›®å½•ã€‚

### éƒ¨ç½²æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1ï¼šç‹¬ç«‹éƒ¨ç½²
- å‰ç«¯ï¼šä½¿ç”¨Nginxæ‰˜ç®¡distç›®å½•
- åç«¯ï¼šä½¿ç”¨PM2è¿è¡ŒNode.jsæœåŠ¡

#### æ–¹æ¡ˆ2ï¼šé›†æˆéƒ¨ç½²
ä¿®æ”¹åç«¯app.jsï¼Œæ·»åŠ é™æ€æ–‡ä»¶æœåŠ¡ï¼š

```javascript
import path from 'path'

// æä¾›å‰ç«¯é™æ€æ–‡ä»¶
app.use(express.static(path.join(__dirname, '../../frontend/dist')))

// æ‰€æœ‰å…¶ä»–è·¯ç”±è¿”å›index.html
app.get('*', (req, res) => {
  res.sendFile(path.join(__dirname, '../../frontend/dist/index.html'))
})
```

## é…ç½®è¯´æ˜

### åç«¯é…ç½®

ä¿®æ”¹ `backend/src/app.js` ä¸­çš„ç«¯å£ï¼š

```javascript
const PORT = process.env.PORT || 3000
```

### å‰ç«¯é…ç½®

ä¿®æ”¹ `frontend/vite.config.js` ä¸­çš„ä»£ç†åœ°å€ï¼š

```javascript
proxy: {
  '/api': {
    target: 'http://localhost:3000',  // åç«¯æœåŠ¡åœ°å€
    changeOrigin: true
  }
}
```

## å¸¸è§é—®é¢˜

### 1. å‰ç«¯æ— æ³•è¿æ¥åç«¯ï¼Ÿ

- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤ç«¯å£é…ç½®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### 2. æ•°æ®æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

æ•°æ®æ–‡ä»¶ä½äº `backend/data/systems.json`ï¼Œé¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨åˆ›å»ºå¹¶åˆå§‹åŒ–7ä¸ªç³»ç»Ÿã€‚

### 3. å¦‚ä½•ä¿®æ”¹é»˜è®¤ç³»ç»Ÿæ•°æ®ï¼Ÿ

æœ‰ä¸¤ç§æ–¹å¼ï¼š
- é€šè¿‡å‰ç«¯"ç³»ç»Ÿç®¡ç†"é¡µé¢ä¿®æ”¹
- ç›´æ¥ä¿®æ”¹ `backend/src/db/database.js` ä¸­çš„ `initialData` å¯¹è±¡ï¼Œç„¶ååˆ é™¤ `backend/data/systems.json` æ–‡ä»¶é‡æ–°å¯åŠ¨

## åç»­è§„åˆ’

- [ ] å®ç°SSOå•ç‚¹ç™»å½•
- [ ] æ·»åŠ ç”¨æˆ·æƒé™ç®¡ç†
- [ ] ç³»ç»Ÿè®¿é—®æ—¥å¿—ç»Ÿè®¡
- [ ] ç³»ç»Ÿå¥åº·æ£€æŸ¥
- [ ] æ”¯æŒç³»ç»Ÿåˆ†ç»„
- [ ] æ·±è‰²æ¨¡å¼æ”¯æŒ

## è®¸å¯è¯

MIT License

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

---

**å¼€å‘è€…**: è¿ç»´å›¢é˜Ÿ
**ç‰ˆæœ¬**: v1.0.0
**æ›´æ–°æ—¶é—´**: 2025-01
